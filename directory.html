<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Directory | Our Festival</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Kanit:wght@300;400;600;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/directory.css">
</head>

<body class="directory-page">

  <div id="header-placeholder"></div>

  <main class="container directory-shell">
    <!-- ===== Hero ===== -->
    <section class="directory-hero rounded-4 p-4 p-lg-5 mb-5">
      <div class="row align-items-center g-4">
        <div class="col-lg-7 text-lg-start text-center">
          <p class="hero-eyebrow mb-2 text-lg-start text-center">Festival Marketplace</p>
          <h1 class="hero-title mb-3 text-lg-start text-center">Discover every booth in one place</h1>
          <p class="hero-subtitle mb-3 text-lg-start text-center">เลือกหมวดที่อยากเดิน กดดูร้านเด่น 3
            ร้านในหมวดนั้นได้ทันที แล้วสลับหมวดด้วยปุ่ม Next/Previous.</p>
          <div class="hero-actions justify-content-lg-start justify-content-center">
            <a href="#categories" class="btn btn-solid">Start browsing</a>
            <a href="#categoryDetail" class="btn btn-ghost">View featured</a>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="hero-stat card text-bg-dark border-0 h-100">
            <div class="card-body d-flex flex-column gap-3">
              <div class="d-flex align-items-center justify-content-between">
                <span class="text-uppercase small text-secondary">Open Today</span>
                <span class="badge bg-warning text-dark">10:00 - 22:00</span>
              </div>
              <div class="d-flex gap-3 align-items-center">
                <div class="stat-bubble">
                  <strong>6</strong>
                  <span>Booths</span>
                </div>
                <div class="stat-bubble">
                  <strong>2</strong>
                  <span>Categories</span>
                </div>
                <div class="stat-bubble">
                  <strong>4.7</strong>
                  <span>Avg Rating</span>
                </div>
              </div>
              <p class="mb-0 text-secondary">คัดร้านเด็ดพร้อมคูปองในแต่ละหมวด
                ลองกดที่การ์ดหมวดเพื่อดูรายละเอียดร้านตัวอย่างได้เลย</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== Categories ===== -->
    <div class="section-block" id="categories">
      <div class="section-heading">
        <span class="pill">Curated Picks</span>
        <h2 class="page-title">Categories</h2>
      </div>

      <div class="row row-cols-1 row-cols-lg-2 g-4 justify-content-start category-row align-items-stretch">
        <div class="col">
          <div class="category-card position-relative overflow-hidden" id="categoryCardPrimary" aria-label="Category">
            <img id="categoryImagePrimary" src="resources/imgForDirectory/candy&drinks.jpg" alt="Category"
              class="category-img">
            <p class="category-name" id="categoryNamePrimary">Category</p>
          </div>
        </div>
        <div class="col d-none d-lg-block">
          <div class="category-card position-relative overflow-hidden" id="categoryCardSecondary" aria-label="Category">
            <img id="categoryImageSecondary" src="resources/imgForDirectory/home-decorations.jpg" alt="Category"
              class="category-img">
            <p class="category-name" id="categoryNameSecondary">Category</p>
          </div>
        </div>
      </div>

      <!-- Mobile category controls -->
      <div class="d-flex d-lg-none justify-content-between align-items-center gap-3 mt-3">
        <button class="btn btn-outline-light btn-sm flex-fill" id="prevCategoryMobile" type="button">Previous</button>
        <button class="btn btn-outline-light btn-sm flex-fill" id="nextCategoryMobile" type="button">Next</button>
      </div>

      <!-- Category detail panel -->
      <div class="collapse mt-4" id="categoryDetail">
        <div class="category-detail-card card border-0 text-bg-dark">
          <div class="card-body p-3 p-lg-4">
            <div class="d-flex flex-wrap justify-content-between align-items-center gap-3 mb-3">
              <div>
                <p class="text-uppercase small text-secondary mb-1" id="categoryLabel">Candy & Drinks</p>
                <h4 class="mb-0">Top picks in this category</h4>
              </div>
            </div>

            <div class="row row-cols-1 row-cols-lg-3 g-3 g-lg-4" id="storeList">
              <!-- Store cards injected here -->
            </div>

            <div class="category-controls d-flex align-items-center justify-content-center gap-3 mt-4">
              <button class="btn btn-outline-light btn-sm" id="prevCategory" type="button">Previous Category</button>
              <span class="text-secondary small" id="categoryProgress">1 / 2</span>
              <button class="btn btn-outline-light btn-sm" id="nextCategory" type="button">Next Category</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </main>

  <div id="footer-placeholder"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const storeData = {
        candy: {
          label: 'Candy & Drinks',
          stores: [
            {
              name: 'Sugar Rush Bar',
              description: 'บาร์ขนมหวานพร้อมโกโก้ร้อน เมนูประจำเทศกาล และมุมถ่ายรูปธีมคริสต์มาส',
              best: 'Peppermint fudge bites',
              hours: '10:00 - 22:00',
              location: 'Lane C2',
              special: 'Free marshmallow topping',
              perks: ['คูปองซื้อ 3 แถม 1', 'ตัวอย่างชิมฟรี', 'มุมถ่ายรูปไฟคริสต์มาส'],
              rating: '4.8',
              tag: 'Signature',
              link: 'booths/booth1.html',
              image: 'resources/imgForDirectory/booth1.jpg'
            },
            {
              name: 'Frostbite Café',
              description: 'เมนูโซดาสีสันและ mocktail กลิ่นซินนามอน เติมฟองครีมวานิลลาได้',
              best: 'Cranberry sparkling soda',
              hours: '10:00 - 22:00',
              location: 'Lane C3',
              special: 'เติมฟองครีมฟรี 1 ครั้ง',
              perks: ['บัตรสะสมแต้ม 5 แก้วรับฟรี 1', 'แก้วลิมิเต็ดลายกวางเรนเดียร์'],
              rating: '4.6',
              tag: 'New',
              link: 'booths/booth2.html',
              image: 'resources/imgForDirectory/booth2.jpg'
            },
            {
              name: 'Ginger & Glow',
              description: 'ช็อคโกแลตร้อนสูตรเข้ม + ขนมปังขิงอบสด เสิร์ฟพร้อมคุกกี้รูปหิมะ',
              best: 'Gingerbread latte',
              hours: '10:00 - 21:30',
              location: 'Lane B1',
              special: 'อัพไซส์ฟรีช่วง 17:00 - 19:00',
              perks: ['โต๊ะอุ่นเทียน', 'คุกกี้ complimentary 1 ชิ้น'],
              rating: '4.9',
              tag: 'Staff pick',
              link: 'booths/booth5.html',
              image: 'resources/imgForDirectory/booth5.jpg'
            }
          ]
        },
        decor: {
          label: 'Home Decorations',
          stores: [
            {
              name: 'North Star Decor',
              description: 'ของตกแต่งคริสต์มาสโทนทองน้ำเงิน ไฟ LED ประหยัดพลังงาน และเซ็ตต้นคริสต์มาส',
              best: 'Aurora light string',
              hours: '10:00 - 22:00',
              location: 'Hall D — Booth 4',
              special: 'ลด 10% เมื่อซื้อครบ 1,500',
              perks: ['มีบริการจัดส่งภายในวัน', 'ทดลองเปิดไฟก่อนซื้อ'],
              rating: '4.7',
              tag: 'Bestseller',
              link: 'booths/booth3.html',
              image: 'resources/imgForDirectory/booth3.jpg'
            },
            {
              name: 'Yuletide Atelier',
              description: 'งานแฮนด์เมดพวงมาลัย มงกุฎดอกไม้ และเทียนหอมกลิ่นสน แพ็กเป็นของขวัญได้',
              best: 'Winter wreath duo',
              hours: '10:00 - 21:00',
              location: 'Hall D — Booth 7',
              special: 'ฟรีป้ายชื่อริบบอน',
              perks: ['มีแพ็กเกจของขวัญ', 'สอนมัดพวงมาลัย 5 นาที'],
              rating: '4.8',
              tag: 'Crafted',
              link: 'booths/booth4.html',
              image: 'resources/imgForDirectory/booth4.jpg'
            },
            {
              name: 'Pine & Patch',
              description: 'ผ้าห่มลายทาร์ทัน หมอนอิง และ diffuser กลิ่นไม้ซีดาร์ สไตล์อบอุ่น',
              best: 'Cedarwood diffuser set',
              hours: '10:00 - 22:00',
              location: 'Hall C — Booth 2',
              special: 'ลดเพิ่ม 5% เมื่อแสดงบัตรนักศึกษา',
              perks: ['ลองกลิ่นได้', 'ผ่อน 0% กับสินค้าชุดใหญ่'],
              rating: '4.5',
              tag: 'Cozy',
              link: 'booths/booth6.html',
              image: 'resources/imgForDirectory/booth6.jpg'
            }
          ]
        }
      };

      const categoryLabel = document.getElementById('categoryLabel');
      const categoryProgress = document.getElementById('categoryProgress');
      const storeList = document.getElementById('storeList');
      const prevCategoryBtn = document.getElementById('prevCategory');
      const nextCategoryBtn = document.getElementById('nextCategory');
      const prevCategoryMobileBtn = document.getElementById('prevCategoryMobile');
      const nextCategoryMobileBtn = document.getElementById('nextCategoryMobile');
      const categoryCardPrimary = document.getElementById('categoryCardPrimary');
      const categoryImagePrimary = document.getElementById('categoryImagePrimary');
      const categoryNamePrimary = document.getElementById('categoryNamePrimary');
      const categoryCardSecondary = document.getElementById('categoryCardSecondary');
      const categoryImageSecondary = document.getElementById('categoryImageSecondary');
      const categoryNameSecondary = document.getElementById('categoryNameSecondary');
      const collapseEl = document.getElementById('categoryDetail');

      const collapseInstance = collapseEl ? new bootstrap.Collapse(collapseEl, { toggle: false }) : null;

      const categoryKeys = Object.keys(storeData);
      const primaryKey = categoryKeys[0] || '';
      const secondaryKey = categoryKeys[1] || categoryKeys[0];
      let activeCategory = primaryKey;

      const renderCategory = () => {
        const category = storeData[activeCategory];
        if (!category) return;
        const idx = categoryKeys.indexOf(activeCategory);
        categoryLabel.textContent = category.label;
        categoryProgress.textContent = `${idx + 1} / ${categoryKeys.length}`;

        storeList.innerHTML = '';
        category.stores.forEach((store) => {
          const col = document.createElement('div');
          col.className = 'col-12 col-lg-4';

          col.innerHTML = `
          <div class="store-card h-100">
            <a class="store-img-wrap d-block" href="${store.link || '#'}" rel="noopener">
              <img src="${store.image}" alt="${store.name}" class="store-img">
              <span class="badge bg-warning text-dark detail-badge">${store.tag || 'Featured'}</span>
            </a>
            <div class="store-body">
              <div class="d-flex justify-content-between align-items-start gap-2 mb-2">
                <div>
                  <p class="text-uppercase small text-secondary mb-1">${category.label}</p>
                  <h5 class="mb-1">${store.name}</h5>
                  <div class="d-flex align-items-center gap-2">
                    <span class="badge bg-success-subtle text-success-emphasis">Open</span>
                    <span class="text-warning small">★ ${store.rating}</span>
                  </div>
                </div>
              </div>
              <p class="text-secondary small mb-3">${store.description}</p>
              <div class="detail-meta mb-3">
                <div class="meta-row">
                  <div>
                    <span class="label">Best Seller</span>
                    <p class="value mb-0">${store.best}</p>
                  </div>
                  <div>
                    <span class="label">Hours</span>
                    <p class="value mb-0">${store.hours}</p>
                  </div>
                </div>
                <div class="meta-row">
                  <div>
                    <span class="label">Location</span>
                    <p class="value mb-0">${store.location}</p>
                  </div>
                </div>
                <div class="meta-row">
                  <div>
                    <span class="label">Special</span>
                    <p class="value mb-0">${store.special}</p>
                  </div>
                </div>
              </div>
              <div class="d-flex flex-wrap gap-2 align-items-center mb-3">
                <span class="text-secondary small">Perks:</span>
                <div class="d-flex flex-wrap gap-2">
                  ${(store.perks || []).map((perk) => `<span class="badge rounded-pill text-bg-secondary">${perk}</span>`).join('')}
                </div>
              </div>
              <div class="d-flex justify-content-between align-items-center gap-2 mt-auto store-footer">
                <a href="${store.link || '#'}" class="btn btn-danger btn-sm rounded-pill" target="_blank" rel="noopener">Visit booth</a>
                <span class="text-secondary small">Open: ${store.hours}</span>
              </div>
            </div>
          </div>
        `;

          storeList.appendChild(col);
        });
      };

      const setCardData = (cardEl, imgEl, nameEl, key) => {
        const category = storeData[key];
        if (!category) return;
        const cover = (category.stores && category.stores[0] && category.stores[0].image) || '';
        if (imgEl && cover) {
          imgEl.src = cover;
          imgEl.alt = category.label;
        }
        if (nameEl) nameEl.textContent = category.label;
        if (cardEl) {
          cardEl.dataset.category = key;
        }
      };

      const updateActiveHighlight = () => {
        [categoryCardPrimary, categoryCardSecondary].forEach((card) => {
          if (!card) return;
          card.classList.toggle('active', card.dataset.category === activeCategory);
        });
      };

      const renderPrimaryForViewport = () => {
        if (window.innerWidth < 992) {
          setCardData(categoryCardPrimary, categoryImagePrimary, categoryNamePrimary, activeCategory);
        } else {
          setCardData(categoryCardPrimary, categoryImagePrimary, categoryNamePrimary, primaryKey);
          setCardData(categoryCardSecondary, categoryImageSecondary, categoryNameSecondary, secondaryKey);
        }
        updateActiveHighlight();
      };

      const handleCardClick = (card) => {
        const key = card?.dataset?.category;
        if (!key || !storeData[key]) return;
        activeCategory = key;
        renderPrimaryForViewport();
        renderCategory();
        if (collapseInstance) {
          collapseInstance.show();
        }
      };

      if (categoryCardPrimary) {
        categoryCardPrimary.addEventListener('click', () => handleCardClick(categoryCardPrimary));
      }
      if (categoryCardSecondary) {
        categoryCardSecondary.addEventListener('click', () => handleCardClick(categoryCardSecondary));
      }

      const switchCategory = (direction) => {
        const currentIndex = categoryKeys.indexOf(activeCategory);
        const nextIndex = (currentIndex + direction + categoryKeys.length) % categoryKeys.length;
        activeCategory = categoryKeys[nextIndex];
        renderPrimaryForViewport();
        renderCategory();
        if (collapseInstance) {
          collapseInstance.show();
        }
      };

      if (prevCategoryBtn) {
        prevCategoryBtn.addEventListener('click', () => switchCategory(-1));
      }

      if (nextCategoryBtn) {
        nextCategoryBtn.addEventListener('click', () => switchCategory(1));
      }

      if (prevCategoryMobileBtn) {
        prevCategoryMobileBtn.addEventListener('click', () => switchCategory(-1));
      }

      if (nextCategoryMobileBtn) {
        nextCategoryMobileBtn.addEventListener('click', () => switchCategory(1));
      }

      // initial state
      renderPrimaryForViewport();
      renderCategory();
      if (collapseInstance) {
        collapseInstance.show();
      }

      window.addEventListener('resize', () => {
        renderPrimaryForViewport();
      });
    });
  </script>
  <script src="js/layout-loader.js"></script>

</body>

</html>